\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or eps with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}

\title{Chapter 3 Notes}
\author{Carl Raymond}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle
\section{Exercies}
\subsection{3.20}

Solve the recurrence twice, with different initial conditions.
\[
	a_n = 3a_{n-1} - 3a_{n-2} + a_{n-3} \quad \text{for $n>2$ with}  \left\{
	\begin{array}{l l}
		\textrm{ $a_0=a_1=0$; $a_2=1$} \\
		\textrm{ $a_0=0$; $a_1 = a_2 = 1$}
	\end{array} \right.
\]

\begin{tabular}{r | r | r}
$n$		& $a_n$	& $a_n$ \\
\hline 
0		& 0		& 0 \\
1		& 0		& 1 \\
2		& 1		& 1 \\
3		& 3		& 0 \\
4		& 6		& -2 \\
5		& 10		& -5 \\
6		& 15		& -9
\end{tabular}

\textbf{First conditions:}
Write an equation valid for $n \ge 0$.
\[
	a_n = 3a_{n-1} - 3a_{n-2} + a_{n=3} + \delta_{n2}
\]

Form the generating function
\[
	A(z) = \sum_{k \ge 0} a_k z^k = 3zA(z) - 3z^2A(z) + z^3A(z) + z^2
\]
\[
	A(z) \left[ 1 -3z + 3z^2 -z^3 \right] = z^2
\]
\[
	A(z) = \frac{z^2}{1-3z+3z^2-z^3}
\]

Since $1-3z+3z^2-z^3 = (1-z)^3$, by partial fraction expansion
\[
	A(z) = \frac{1}{1-z} - \frac{2}{(1-z)^2}  + \frac{1}{(1-z)^3}
\]

Extract coefficients for a closed form for $a_n$:
\begin{align*}
	a_n &= \left[z^n\right] \frac{1}{1-z} - \left[z^n\right] \frac{2}{(1-z)^2} + \left[z^n\right] \frac{1}{(1-z)^3} \\
		&= 1 - 2(n+1) + \frac{(n+1)(n+2)}{2} \\
		&= \frac{n(n-1)}{2}
\end{align*}

\textbf{Second conditions:} Write an equation valid for all $n \ge 0$:
\[
	a_n = 3a_{n-1} - 3a_{n-2} + a_{n-3} + \delta_{n1} - 2\delta_{n2}
\]
Form the generating function
\[
	A(z) = \sum_{k \ge 0} a_k z^k = 3zA(z) - 3z^2A(z) + z^3A(z) + z - 2z^2
\]
Collecting terms,
\[
	A(z) \left[ 1 - 3z + 3z^2 - z^3 \right] = z - 2z^2
\]
\[
	A(z) = \frac{z-2z^2}{1-3z+3z^2-z^3} \\
\]
By partial fraction expansion,
\begin{align*}
	A(z) &= \frac{2}{z-1} + \frac{3}{(z-1)^2} + \frac{1}{(z-1)^3} \\
		&= \frac{-2}{(1-z)} + \frac{3}{(1-z)^2} - \frac{1}{(1-z)^3}
\end{align*}

Extract coefficients for a closed for for $a_n$:
\begin{align*}
	a_n &= \left[z^n\right] \frac{-2}{(1-z)} + \left[z^n\right] \frac{3}{(1-z)^2} - \left[z^n\right] \frac{1}{(1-z)^3} \\
		&= -2 + 3(n+1) - \frac{(n+1)(n+2)}{2} \\
		&= \frac{(3-n)n}{2} 
\end{align*}

\end{document}  