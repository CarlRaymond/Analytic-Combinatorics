\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or eps with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}
\title{Notes on Chapter 2}
\author{Carl Raymond}
%\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle
%\section{}
%\subsection{}

\section{Excercises}

\subsection*{Exercise 2.6} Solve the recurrence
\[
	a_n = a_{n-1} + a_{n-2} \quad \text{for $n>1$ with $a_0=p$ and $a_1=q$,}
\]
expressing your answer in terms of the Fibonacci numbers $F_n$.

From the definition of the recurrence,

\begin{tabular}{r | r c r | r}
	n	& & $a_n$ & & $F_n$ \\
	\hline
	0	& $p$ & & 			& 0 \\
	1	& & & $q$ 			& 1 \\
	2	& $p$ & {}+{} & $q$		& 1 \\
	3	& $p$ & {}+{} & $2q$		& 2 \\
	4	& $2p$ & {}+{} & $3q$ 	& 3 \\
	5	& $3p$ & {}+{} & $5q$ 	& 5 \\
	6	& $5p$ & {}+{} & $8q$	& 8
\end{tabular}

By inspection, $a_n = pF_{n-1} + qF_{n}$ for $n>1$ with $a_0=p$ and $a_1=q$.

Since $a_n = f(a_{n-1}, a_{n-2})$ where $f(a, b) = a+b$ (a homogeneous function because $f(0,0)=0$), apply the linearity rule:
\[
	a_n = a_0 u_n + a_1 v_n
\]
where
\[u_n = f(u_{n-1}, u_{n-2}) \quad \text{for $n>1$ with $u_0=1$ and $u_1=0$}\] and
\[v_n = f(v_{n-1}, v_{n-2}) \quad \text{for $n>1$ with $v_0=0$ and $v_1=1$}\]
But by these definitions $u_n = F_{n-1}$ and $v_n = F_n$, so $a_n = pF_{n-1} + qF_n$.

\subsection*{Excercise 2.7}
Solve the inhomogeneous recurrence
\[
	a_n = a_{n-1} + a_{n-2} + r \quad \text{for $n>1$ with $a_0=p$ and $a_1=q$}
\]
expressing your answer in terms of the Fibonacci numbers $F_n$.

From the definition of the recurrence,

\begin{tabular}{r | r c r c r | r}
	n	& & & $a_n$ & & 				& $F_n$\\
	\hline
	0	&  $p$ & & & &						& 0 \\
	1	& & & $q$ & &						& 1 \\
	2	& $p$ & {}+{} & $q$ & {}+{} & $r$		& 1 \\
	3	& $p$ & {}+{} & $2q$ & {}+{} & $2r$ 		& 2\\
	4	& $2p$ & {}+{} & $3q$ & {}+{} & $4r$		& 3 \\
	5	& $3p$ & {}+{} & $5q$ & {}+{} & $7r$  	& 5 \\
	6	& $5p$ & {}+{} & $8q$ & {}+{} & $12r$	& 8 \\
	7	& $8p$ & {}+{} & $13q$ & {}+{} & $20r$	& 13

\end{tabular}

From inspection, the coefficients of $p$ and $q$ are as above; the coefficient of the $r$ term is the partial sum of Fibonacci numbers:
\[
	a_n = F_{n-1}p + F_n q + \left(\sum_{k<n} F_k \right) r
\]

The coefficients of $F_{n-1}$ and $F_n$ are established above.  For the coefficient of $r$ the proof is by induction. Let $R_n$ be the coefficient
of $r$ in $a_n$. Then assume $R_{n-1} = \sum_{0 \le k < n-1} F_k$ and $R_{n-2} = \sum_{0 \le k < n-2} F_k$. This is true for $R_0$ and $R_1$.

By definition of the recurrence on $a_n$, $R_n = R_{n-1} + R_{n-2} + 1$ for $n>1$:
\begin{align*}
	R_n &= F_0 + F_1 + F_2 + \cdots + F_{n-2}  \\
		&+ \qquad  F_0 + F_1 +  \cdots + F_{n-3} +  1
\end{align*}
Adding in columns, and noticing that the lonely 1 at the end is really $F_1$ in disguise,
\[
	R_n = F_0 + F_2 + F_3 + \cdots + F_{n-1} + F_1
\]
and so the sum is over all $F_k$ for $k < n$.

\subsection*{Exercise 2.8}
For $f$ linear, express the solution to the recurrence
\[
	a_n = f(a_{n-1}, a_{n-2}) \quad \text{for $n>1$}
\]
in terms of $a_0$, $a_1$, $f(0,0)$ and the solutions to $a_n = f(a_n-1, a_n-2) - f(0,0)$ for $a_1=1$, $a_0=0$ and $a_0=1$, $a_1=0$.

\subsection*{Exercise 2.9}
Solve the recurrence 
\[
	a_n = \frac{n}{n+2}a_{n-1} \quad \text{for $n>0$ with $a_0=1$.}
\]
By telescoping the product,
\[
	a_n = \left(\frac{n}{n+2}\right)  \left(\frac{n-1}{n+1}\right)  \left(\frac{n-2}{n}\right)  \cdots \left(\frac{1}{3}\right) a_0
\]
Cancelling factors,
\[
	a_n = \frac{2}{(n+2)(n+1)}
\]

\subsection*{Exercise 2.10}
Solve the recurrence
\[
	a_n = a_{n-1} + (-1)^n n \quad \text{for $n>0$ with $a_0=1$.}
\]

\subsection*{Exercise 2.11}

Solve the recurrence
\[
	a_n = (n-2)a_{n-1} + 2 \quad \text{for $n>1$ with $a_1=1$.}
\]


\section*{Theorem 2.1}
First-order linear recurrences. The recurrence
\[
	a_n = x_n a_{n-1} + y_n \quad \text{for $n>0$ with $a_0=0$}
\]
has the explicit solution
\[
	a_n = y_n + \sum_{1 \le j < n} y_j x_{j+1} x_{j+2} \cdots x_n
\]

\subsection*{Exercise 2.13}
Solve the recurrence
\[
	a_n = \frac{n}{n+1} a_{n-1} + 1	\quad \text{for $n>0$ with $a_0=1$.}
\]

Define $x_j = \frac{j}{j+1}$ and $y_j=1$.
\begin{align*}
	a_0 &= 1 \\
	a_1 &= x_1 a_0 + 1 \\
	a_2 &= x_2 (x_1 a_0 + 1) + 1
\end{align*}

By Theorem 2.1,
\begin{align*}
	a_n &= y_n + \sum_{1\le j < n} y_j x_{j+1} x_{j+2} \cdots x_n \\
		&= 1 + \sum_{1 \le j < n} \left(\frac{j+1}{j+2}\right) \left(\frac{j+2}{j+3}\right) \cdots \left(\frac{n}{n+1}\right) \\
		&= 1 + \sum_{1 \le j < n} \frac{j+1}{n+1} \\
		&= 1 + \sum_{1 < j \le n} \frac{j}{n+1} \quad \text{(adjust limits of sum)} \\
		&= 1 + \frac{1}{n+1} \sum_{1 < j \le n} j \\
		&= 1 + \frac{1}{n+1} \left( \frac{n(n+1)}{2} -1 \right) \\
		&= 1 + \left( \frac{n}{2} - \frac{1}{n+1} \right)
\end{align*}

\subsection*{Exercise 2.14}


****Write down the solution to
\[
	a_n = x_n a_{n-1} + y_n \quad \text{for $n>t$}
\]
in terms of the $x$'s, the $y$'s, and the initial value $a_t$.

Define $b_n = a_{n-t}$.  Then by Theorem 2.1,
\[
	b_n = y_n + \sum_{1 \le j < n} y_j x_{j+1} x_{j+2} \cdots x_n
\]


\subsection*{Exercis 2.17}
[Yao] (``Fringe analysis of 2-3 trees''). Solve the recurrence
\[
	A_N = A_{N-1} - \frac{2A_{N-1}}{N} + 2 \left( 1 - \frac{2A_{N-1}}{N} \right) \quad \text{for $N>0$ with $A_0=0$.}
\]

\section{Master Theorem for Recurrences}
Divde-and-conquer algorithms divide a problem of size $N$ into $\alpha$ smaller problems of size $\beta$, which are solved recursively.
The cost to do the dividing and recombining is $\Theta(n^\gamma (\log n)^\delta$).
The solution to the recurrence
\[
	a_n = a_{n/\beta +O(1)} + a_{n/\beta+O(1)} + a_{n/\beta +O(1)} + \dots + \Theta(n^\gamma+(\log(n))^\delta)
\]
where the sum has $\alpha$ terms is given by
\begin{align}
	a_n &= \Theta(n^\gamma (\log n)^\delta)         &&\text{when } \gamma < \log_\beta \alpha \\
	a_n &=\Theta(n^\gamma (\log n)^{\delta+1})   &&\text{when } \gamma = \log_\beta \alpha \\
	a_n &=\Theta(n^{log_\beta \alpha})                   &&\text{when } \gamma > \log_\beta \alpha \\
\end{align}

For Quicksort, $\alpha=2$, $\beta=2$, $\gamma=1$, $\delta=0$. Then the asymptotic cost is $\Theta(N \log N)$.

For a Batcher network, $\alpha=2$, $\beta=2$, $\gamma=1$, $\delta=1$. The cost is $\Theta(N(\log N)^2)$.

For Karatsuba multiplication, $\alpha=3$, $\beta=2$, $\gamma=1$, $\delta=0$. The cost is $\Theta(N^{\log_2 3}) = \Theta(N^{1.585...})$.

For Strassen matrix multiplication, $\alpha=7$, $\beta=2$, $\gamma=1$, $\delta=0$. The cost is $\Theta(N^{\log_2 7}) = \Theta(N^{2.807...})$.
\end{document}  